---
layout: photo
title: JMeter服务器性能资源监控
tags:
  - 测试
date: 2020-03-21 22:23:38
categories: 测试
photos:
---
简单介绍一下jmeter压测时如何对服务器性能监控。
<!--more-->
####  安装插件plugins-manager
[点击下载plugins-manager](**https://jmeter-plugins.org/install/Install**)，将下载后文件放置到JMeter文件的lib/ext目录下，重启JMeter。

<img src="/image/JMeter/JMeter-0.png">
<img src="/image/JMeter/JMeter-1.png">

#### 安装PerfMon插件

<img src="/image/JMeter/JMeter-2.png">

#### 下载ServerAgent
1. 去github的[perfmon-agent](https://github.com/undera/perfmon-agent)项目中下载

<img src="/image/JMeter/JMeter-3.png">

2. 将压缩包上传至服务器，服务器需安装jdk，版本要在jdk8以上。

3. 解压压缩包，进入目录后执行chmod 777 startAgent.sh

4. 执行./startAgent.sh，默认端口为4444

若端口冲突，需修改端口，命令为：

```bash
# 第一种命令
./startAgent.sh --udp-port 7777 --tcp-port 7777
# 第二种命令
java -jar ./CMDRunner.jar --tool PerfMonAgent --udp-port 7879 --tcp-port 7879
```

校验ServerAgent是否可以使用

Windows系统进入cmd命令行，输入如下内容

```shell
telnet 部署服务器外网IP 启动端口号
```

出现如下提示：

*C:\Users\xb>telent 129.204.169.23 8000*
*'telent' 不是内部或外部命令，也不是可运行的程序*
*或批处理文件。*

解决方案：

1. "开始菜单" --> 右键 --> "应用和功能" --> "程序和功能（右上角）"

<img src="/image/JMeter/JMeter-7.png">

2. "启动或关闭Windows功能" --> 勾上"Telnet Client" --> 确定。

<img src="/image/JMeter/JMeter-8.png">

#### 在JMeter中添加监听器
1. 添加监听器jp@gc - PerfMon Metrics Collector
<img src="/image/JMeter/JMeter-5.png">
2. 配置要监听的资源
<img src="/image/JMeter/JMeter-6.png">