---
layout: photo
title: Django自定义装饰器限制登录访问
tags:
  - Django
date: 2019-04-18 22:52:15
categories: Django
photos:
---
带登录的系统很多页面需要登录验证通过后才可以进行访问。
<!--more-->
#### 基于cookie和装饰器实现用户认证
```python
def check_login_status(func):
    def wrapper(reqeust,*args,**kwargs):
        user = reqeust.COOKIES.get('login_user')
        if not user:
            return redirect('/login')
        return func(reqeust, *args,**kwargs)
    return wrapper

@check_login_status
def index(request):
    '''主页'''
    .......
    return render(request,'index.html')
```
#### 基于session和装饰器实现用户认证
```python
def check_login_status(func):
    def wrapper(request, *args, **kwargs):
        user = request.session.get('login_user', None)  # 获取session值
        # user = request.session.has_key('login_user')
        if not user:  #判断是否已经登录
            return redirect('/login')   #如果没有登录返回登录页面
        return func(request, *args, **kwargs)  # 如果已经登录返回原函数请求页面
    return wrapper
    
@check_login_status
def index(request):
    '''主页'''
    .......
    return render(request,'index.html')
```

