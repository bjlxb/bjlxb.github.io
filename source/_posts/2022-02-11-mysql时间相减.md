---
layout: photo
title: mysql时间相减
tags:
  - DB
date: 2022-02-11 17:01:59
categories: DB
photos:
---
工作中遇到需要查询时间相减的数据
<!--more-->
MySQL中时间不能直接相减，如果日、分、时不同，相减结果是错误的。

mysql的时间相减是做了一个隐式转换操作，将时间转换为整数，但不是用unix_timestamp进行转换，而是直接把年月日时分秒拼起来，如2022-02-15 13:59:59 直接转换为20220215135959，由于时间不是十进制，所以最后得到的结果没有意义。

时间相减的三种解决方案：
```mysql
time_to_sec(timediff(t2, t1)), -- t2-t1
timestampdiff(second, t1, t2), -- t2-t1
unix_timestamp(t2) - unix_timestamp(t1) -- t2-t1
```
例：
```mysql
SELECT create_date, verify_time, time_to_sec(timediff(verify_time, create_date)), timestampdiff(second, create_date, verify_time),unix_timestamp(verify_time) - unix_timestamp(create_date) 
FROM order
```

