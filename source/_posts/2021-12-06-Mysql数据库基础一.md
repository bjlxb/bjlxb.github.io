---
layout: photo
title: Mysql数据库基础一
tags:
  - 测试
date: 2021-12-06 21:07:45
categories: 测试
photos:
---
复习一下Mysql数据库基础知识
<!--more-->
### 1、关系型数据库、主键、外键、索引概念
关系型数据库是由多张能互相联接的二维行列表格组成的数据库
主关键字(primary key)是表中的一个或多个字段，它的值用于唯一地标识表中的某一条记录 
外键表示了两个关系之间的相关联系。以另一个关系的外键作主关键字的表被称为主表，具有此外键的表被称为主表的从表。外键又称作外关键字
在关系数据库中，索引是一种单独的、物理的对数据库表中一列或多列的值进行排序的一种存储结构，它是某个表中一列或若干列值的集合和相应的指向表中物理标识这些值的数据页的逻辑指针清单
### 2、表的连接查询方式，区别
交叉连接即笛卡儿乘积，是指两个关系中所有元组的任意组合 
使用内连接时，如果两个表的相关字段满足连接条件，就从这两个表中提取数据并组合成新的记录 
自连接是一种特殊的内连接，它是指相互连接的表在物理上为同一张表，但可以在逻辑上分为两张表 
外连接是只限制一张表中的数据必须满足连接条件，而另一张表中的数据可以不满足连接条件的连接方式
### 3、SQL 的 select 语句完整的执行顺序
1、from 子句组装来自不同数据源的数据; 
2、where 子句基于指定的条件对记录行进行筛选; 
3、group by 子句将数据划分为多个分组; 
4、使用聚集函数进行计算;
5、使用 having 子句筛选分组; 
6、计算所有的表达式;
7、select 的字段;
8、使用 order by 对结果集进行排序。

### 4、Mysql数据库存储的原理
储存过程是一个可编程的函数，它在数据库中创建并保存。它可以有 SQL 语句和一些特殊的控制结构组成。当希望在不同的应用程序或平台上执行相同的函数，或者封装特定功能时，存储过程是非常有用的。数据库中的存储过程可以看做是对编程中面向对象方法的模拟。它允许控制数据的访问方式。存储过程通常有以下优点:
1、存储过程能实现较快的执行速度；
2、存储过程允许标准组件是编程； 
3、存储过程可以用流程控制语句编写，有很强的灵活性，可以完成复杂的判断和较复杂的运算；
4、存储过程可被作为一种安全机制来充分利用；
5、存储过程能够减少网络流量；

### 5、事务的特性
1、原子性(Atomicity):事务中的全部操作在数据库中是不可分割的，要么全部完成，要么均不执行；
2、一致性(Consistency):几个并行执行的事务，其执行结果必须与按某一顺序串行执行的结果相一致；
3、隔离性(Isolation):事务的执行不受其他事务的干扰，事务执行的中间结果对其他事务必须是透明的；
4、持久性(Durability):对于任意已提交事务，系统必须保证该事务对数据库的改变不被丢失，即使数据库出现故障；

### 6、数据库索引
数据库索引，是数据库管理系统中一个排序的数据结构，以协助快速查询、更新数据库表中数据。索引的实现**通常使用B_TREE**。
B_TREE索引加速了数据访问，因为存储引擎不会再去扫描整张表得到需要的数据;相反，它从根节点开始，根节点保存了子节点的指针，存储引擎会根据指针快速寻找数据。

### 7、数据库优化查询效率
1、储存引擎选择:如果数据表**需要事务处理，应该考虑使用InnoDB**，因为它完全符合 ACID 特性。如果不需要事务处理，使用默认存储引擎MyISAM 是比较明智的；
2、分表分库，主从；
3、对查询进行优化，要尽量避免全表扫描，首先应考虑在 where 及 order by 涉及的列上建立索引；
4、应尽量避免在 where 子句中对字段进行 null 值判断，否则将导致引擎放弃使用索引而进行全表扫描；
5、应尽量避免在 where 子句中使用!= 或<>操作符，否则将引擎放弃使用索引而进行全表扫描；
6、应尽量避免在 where 子句中使用 or 来连接条件，如果一个字段有索引，一个字段没有索引，将导致引擎放弃使用索引而进行全表扫描；
7、Update 语句，如果只更改 1、2 个字段，不要 Update 全部字段，否则频繁调用会引起明显的性能消耗，同时带来大量日志；
8、对于多张大数据量(这里几百条就算大了)的表JOIN，要先分页再JOIN，否则逻辑读会很高，性能很差；

### 8、Mysql各引擎的区别
主要 MyISAM 与 InnoDB 两个引擎，其主要区别如下:InnoDB 支持事务，MyISAM 不支持，这一点是非常之重要。事务是一种高级的处理方式，如在一些列增删改中只要哪个出错还可以回滚还原，而 MyISAM 就不可以了;
MyISAM 适合查询以及插入为主的应用，InnoDB 适合频繁修改以及涉及到安全性较高的应用; 
InnoDB 支持外键，MyISAM 不支持;
MyISAM 是默认引擎，InnoDB 需要指定;
InnoDB 不支持 FULLTEXT 类型的索引;
InnoDB 中不保存表的行数，如 select count() from table 时，InnoDB需要扫描一遍整个表来计算有多少行，但是 MyISAM 只要简单的读出保存好的行数即可。注意的是，当 count()语句包含 where 条件时 MyISAM 也需要扫描 整个表;
对于自增长的字段，InnoDB 中必须包含只有该字段的索引，但是在 MyISAM 表中可以和其他字段一起建立联合索引;
清空整个表时，InnoDB 是一行一行的删除，效率非常慢。MyISAM 则会重建表;
InnoDB 支持行锁(某些情况下还是锁整表，如 update table set a=1 where user like '%lee%';

### 10、查询命令进行优化
a. 应尽量避免全表扫描，首先应考虑在 where 及 order by 涉及的列上建立索。
b. 应尽量避免在 where 子句中对字段进行 null 值判断，避免使用!=或<>操作符，避免使用 or 连接条件，或在 where 子句中使用参数、对字段进行表达式或函数操作，否则会导致权标扫描。
c. 不要在 where 子句中的“=”左边进行函数、算术运算或其他表达式运算，否则系统将可能无法正确使用索引。
d. 使用索引字段作为条件时，如果该索引是复合索引，那么必须使用到该索引中的第一个字段作为条件时才能保证系统使用该索引，否则该索引将不会被使用。
e. 很多时候可考虑用 exists 代替 in。
f. 尽量使用数字型字段。
g. 尽可能的使用 varchar/nvarchar 代替 char/nchar。
h. 任何地方都不要使用 select from t ，用具体的字段列表代替""，不要返回用不到的任何字段。
i. 尽量使用表变量来代替临时表。
j. 避免频繁创建和删除临时表，以减少系统表资源的消耗。
k. 尽量避免使用游标，因为游标的效率较差。
l. 在所有的存储过程和触发器的开始处设置 SET NOCOUNT ON ，在结束时设置 SETNOCOUNT OFF。
m. 尽量避免大事务操作，提高系统并发能力。
n. 尽量避免向客户端返回大数据量，若数据量过大，应该考虑相应需求是否合理。



<img src="/image/">

